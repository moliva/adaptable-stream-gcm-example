<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE definition PUBLIC "-//objectweb.org//DTD Fractal ADL 2.0//EN" "classpath://org/objectweb/proactive/core/component/adl/xml/proactive.dtd">

<definition name="org.inria.scale.streams.examples.MapExampleApp" extends="org.inria.scale.streams.DataStreamApplication">

	<!-- InputSystemReader -->
	<component name="lines-reader" definition="org.inria.scale.streams.InTap">
		<content class="org.inria.scale.streams.intaps.SystemInputLineReader" />
	</component>

	<!-- Input window -->
	<component name="input-window" definition="org.inria.scale.streams.Window">
		<attributes signature="org.inria.scale.streams.configuration.WindowConfiguration">
			<attribute name="windowConfiguration" value='( "type": "tumbling", "tumblingType": "time", "milliseconds": 5000 )' />
		</attributes>
	</component>

	<!-- Map -->
	<component name="map" definition="org.inria.scale.streams.Operator">

		<component name="worker0" definition="org.inria.scale.streams.Worker">
			<content class="org.inria.scale.streams.map.ReflectionMapWorker" />
		</component>

		<component name="worker1" definition="org.inria.scale.streams.Worker">
			<content class="org.inria.scale.streams.map.ReflectionMapWorker" />
		</component>

		<component name="impl" definition="org.inria.scale.streams.Operator">
			<interface name="workers" role="client" cardinality="multicast" signature="org.inria.scale.streams.map.MulticastMapWorker" />
			<content class="org.inria.scale.streams.operators.Map" />
		</component>

		<binding client="impl.workers" server="worker0.in" />
		<binding client="impl.workers" server="worker1.in" />

		<binding client="this.in" server="impl.in" />
		<binding client="impl.out" server="this.out" />

		<controller desc="composite" />
	</component>
	<!-- <attributes signature="org.inria.scale.streams.configuration.SortByConfiguration"> -->
	<!-- <attribute name="tupleComponent" value="1" /> -->
	<!-- <attribute name="order" value="desc" /> -->
	<!-- </attributes> -->

	<!-- SystemOutputWriter -->
	<component name="system-output" definition="org.inria.scale.streams.OutTap">
		<content class="org.inria.scale.streams.outtaps.SystemOutputWriter" />
	</component>

	<!-- Operator bindings -->
	<binding client="lines-reader.out" server="input-window.in" />

	<!-- <binding client="input-window.out" server="system-output.in" /> -->

	<binding client="input-window.out" server="map.in" />
	<binding client="map.out" server="system-output.in" />

</definition>
